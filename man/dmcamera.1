.TH "DMCAMERA" "1" "" "Version 2.0.0" "User Commands"
.SH NAME
dmcamera \(en captures images from webcam or IP camera
.SH SYNOPSIS
\f[B]dmcamera\f[R] \-\-help
.PP
\f[B]dmcamera\f[R] \-\-version
.PP
\f[B]dmcamera\f[R] \-\-\f[B]node\f[R] \f[I]id\f[R] \-\-\f[B]sensor\f[R]
\f[I]id\f[R] \-\-\f[B]target\f[R] \f[I]id\f[R] \-\-\f[B]directory\f[R]
\f[I]path\f[R] \-\-\f[B]device\f[R] \f[I]name\f[R] \-\-\f[B]input\f[R]
\f[I]path\f[R] [\-\-\f[B]interval\f[R] \f[I]n\f[R]] [\-\-\f[B]mime\f[R]
\f[I]name\f[R]] [\-\-\f[B]width\f[R] \f[I]n\f[R]] [\-\-\f[B]height\f[R]
\f[I]n\f[R]] [\-\-\f[B]database\f[R] \f[I]file\f[R]]
[\-\-\f[B]logger\f[R] \f[I]name\f[R]] [\-\-\f[B]font\f[R]
\f[I]name\f[R]] [\-\-\f[B]fontsize\f[R] \f[I]n\f[R]]
[\-\-\f[B]debug\f[R]] [\-\-\f[B]ipc\f[R]] [\-\-\f[B]overlay\f[R]]
.PP
\f[B]dmcamera\f[R] \-\-\f[B]config\f[R] \f[I]file\f[R]
[\-\-\f[B]name\f[R] \f[I]name\f[R]]
.SH DESCRIPTION
The \f[B]dmcamera\f[R] program captures images of an attached USB webcam
(V4L2) or remote IP camera (RTSP).
The images are written to file in JPEG or PNG format.
If an image database is specified, the image meta data is added to the
database.
The database can be created with \f[I]dminit(1)\f[R].
The program depends on FFmpeg and GraphicsMagick.
The executables \f[I]ffmpeg(1)\f[R] and \f[I]gm(1)\f[R] are required.
.PP
Optionally, a text overlay may be added to the image, containg the date
and time it was captured in ISO 8601.
The overlay font must be known to GraphicsMagick.
For a list of all fonts supported by GraphicsMagick, run:
.IP
.EX
$ gm convert \-list font
.EE
.PP
You may have to modify the GraphicsMagick configuration file
\f[CR]type.mgk\f[R] according to the fonts installed on the system.
.SH OPTIONS
.TP
\f[B]\-\-config\f[R], \f[B]\-c\f[R] \f[I]file\f[R]
Path to configuration file.
.TP
\f[B]\-\-database\f[R], \f[B]\-d\f[R] \f[I]file\f[R]
Path to SQLite image database.
.TP
\f[B]\-\-debug\f[R], \f[B]\-D\f[R]
Forward logs messages of level \f[CR]LL_DEBUG\f[R] via IPC (if logger is
set).
.TP
\f[B]\-\-directory\f[R], \f[B]\-p\f[R] \f[I]path\f[R]
Directory to store the image files in.
.TP
\f[B]\-\-device\f[R], \f[B]\-C\f[R] [rtsp|v4l2]
Camera device type (RTSP or V4L2).
.TP
\f[B]\-\-font\f[R], \f[B]\-F\f[R] \f[I]name\f[R]
Name of font to use for overlay text.
The font must be known to GraphicsMagick (default: DejaVuSansMono).
.TP
\f[B]\-\-fontsize\f[R], \f[B]\-Z\f[R] \f[I]n\f[R]
Font size of overlay text (default: 12).
.TP
\f[B]\-\-height\f[R], \f[B]\-H\f[R] \f[I]n\f[R]
Desired image height.
May be ignored if unsupported by camera.
.TP
\f[B]\-\-help\f[R], \f[B]\-h\f[R]
Print available command\-line arguments and quit.
.TP
\f[B]\-\-input\f[R], \f[B]\-i\f[R] \f[I]path\f[R]
URL of RTSP stream or path of V4L2 device (for example,
\f[CR]rtsp://localhost/\f[R] or \f[CR]/dev/video0\f[R]).
.TP
\f[B]\-\-interval\f[R], \f[B]\-I\f[R] \f[I]n\f[R]
Capture interval in seconds.
By default, the interval is 0, which means that only a single image is
captured.
.TP
\f[B]\-\-ipc\f[R], \f[B]\-Q\f[R]
Uses a POSIX semaphore for process synchronisation.
The name of the semaphore matches the instance name (with leading
\f[CR]/\f[R]).
The semaphore is set to 1 each time an image has been captured.
Only a single process shall wait for this semaphore, otherwise, reading
occurs in round\-robin fashion.
.TP
\f[B]\-\-logger\f[R], \f[B]\-l\f[R] \f[I]name\f[R]
Name of logger.
If set, sends logs to \f[I]dmlogger(1)\f[R] process of given name.
.TP
\f[B]\-\-mime\f[R], \f[B]\-M\f[R] \f[I]name\f[R]
MIME type of image format to use, either \f[CR]image/jpeg\f[R] or
\f[CR]image/png\f[R].
.TP
\f[B]\-\-name\f[R], \f[B]\-n\f[R] \f[I]name\f[R]
Name of program instance, configuration, and POSIX semaphore (default is
\f[CR]dmcamera\f[R]).
.TP
\f[B]\-\-node\f[R], \f[B]\-N\f[R] \f[I]id\f[R]
Node id.
.TP
\f[B]\-\-overlay\f[R], \f[B]\-O\f[R]
Add date and time in ISO 8601 as overlay text to image.
.TP
\f[B]\-\-sensor\f[R], \f[B]\-S\f[R] \f[I]id\f[R]
Sensor id of camera.
.TP
\f[B]\-\-target\f[R], \f[B]\-T\f[R] \f[I]id\f[R]
Target id of camera.
.TP
\f[B]\-\-verbose\f[R], \f[B]\-V\f[R]
Print log messages to \f[I]stderr\f[R].
.TP
\f[B]\-\-version\f[R], \f[B]\-v\f[R]
Print version information and quit.
.TP
\f[B]\-\-width\f[R], \f[B]\-W\f[R] \f[I]n\f[R]
Desired image width.
May be ignored if unsupported by camera.
.SH EXIT STATUS
.TP
\f[B]0\f[R]
Success.
Program executed without errors.
.TP
\f[B]1\f[R]
Failure.
Program execution failed.
.SH ENVIRONMENT
.TP
\f[B]DM_LOGGER\f[R]
Name of logger instance to send logs to.
.TP
\f[B]NO_COLOR\f[R]
Disable ANSI colour output.
.SH EXAMPLE
Capture an image from an attached USB webcam (V4L2), write image to
directory \f[CR]/tmp\f[R], and add a text overlay with date and time in
ISO 8601:
.IP
.EX
$ dmcamera \-N dummy\-node \-S dummy\-sensor \-T dummy\-target \(rs
  \-p /tmp \-C v4l2 \-i /dev/video0 \-O \-V
.EE
.SH SEE ALSO
\f[I]dminit(1)\f[R], \f[I]dmupload(1)\f[R]
