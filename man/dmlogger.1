.TH "DMLOGGER" "1" "" "Version 2.0.0" "User Commands"
.SH NAME
dmlogger \(en inserts collected log messages into database
.SH SYNOPSIS
\f[B]dmlogger\f[R] \-\-help
.PP
\f[B]dmlogger\f[R] \-\-version
.PP
\f[B]dmlogger\f[R] \-\-\f[B]node\f[R] \f[I]id\f[R]
[\-\-\f[B]database\f[R] \f[I]file\f[R]] [\-\-\f[B]output\f[R]
\f[I]file\f[R]] [\-\-\f[B]minlevel\f[R] \f[I]n\f[R]] [\-\-\f[B]ipc\f[R]]
[\-\-\f[B]verbose\f[R]]
.PP
\f[B]dmlogger\f[R] \-\-\f[B]config\f[R] \f[I]file\f[R]
[\-\-\f[B]name\f[R] \f[I]name\f[R]]
.SH DESCRIPTION
The \f[B]dmlogger\f[R] program collects log messages from a POSIX
message queue and inserts them into a SQLite database.
The name of the message queue matches the given \f[B]dmlogger\f[R] name,
by default \f[CR]/dmlogger\f[R].
.PP
If a minimum log level is selected, only logs of a level greater equal
the minimum are written to log file or log database.
Log messages with lower level are discarded.
.PP
The option \f[CR]\-\-ipc\f[R] enables process synchronisation via POSIX
semaphores.
The semaphore value is incremented from 0 to 1 whenever a new log has
been delivered.
The name of the semaphore equals the \f[B]dmlogger\f[R] name with
leading \f[CR]/\f[R].
Only a single process shall wait for the semaphore unless round\-robin
IPC is desired.
This option may be used to synchronise incoming log messages
automatically with a remote RPC API server.
For example, pass the \f[B]dmlogger\f[R] name to \f[I]dmsync(1)\f[R]
through command\-line argument \f[CR]\-\-wait\f[R].
The semaphore will then trigger the log synchronisation.
.SH OPTIONS
.TP
\f[B]\-\-config\f[R], \f[B]\-c\f[R] \f[I]file\f[R]
Path to configuration file.
.TP
\f[B]\-\-database\f[R], \f[B]\-d\f[R] \f[I]file\f[R]
Path to SQLite log database.
.TP
\f[B]\-\-help\f[R], \f[B]\-h\f[R]
Print available command\-line arguments and quit.
.TP
\f[B]\-\-ipc\f[R], \f[B]\-Q\f[R]
Use POSIX semaphore for process synchronisation.
The name of the semaphore matches the instance name (with leading
slash).
The semaphore is set to 1 each time a log message has been received.
Only a single process shall wait for this semaphore.
.TP
\f[B]\-\-minlevel\f[R], \f[B]\-L\f[R] \f[I]level\f[R]
Minimum level for a log to be stored in the database, from 1
(\f[CR]LL_DEBUG\f[R]) to 5 (\f[CR]LL_CRITICAL\f[R]).
The argument may be an integer or name string.
.TP
\f[B]\-\-name\f[R], \f[B]\-n\f[R] \f[I]name\f[R]
Name of logger instance, configuration, POSIX message queue, and POSIX
semaphore (default is \f[CR]dmlogger\f[R]).
.TP
\f[B]\-\-node\f[R], \f[B]\-N\f[R] \f[I]id\f[R]
Node id.
.TP
\f[B]\-\-output\f[R], \f[B]\-o\f[R] \f[I]file\f[R]
Path of log file.
If the file does not exist, a new log file will be created.
Logs are appended to the end of the file.
If set to \f[CR]\-\f[R], logs are printed to \f[I]stderr\f[R] (equals
argument \f[CR]\-\-verbose\f[R]).
.TP
\f[B]\-\-verbose\f[R], \f[B]\-V\f[R]
Print received logs to \f[I]stderr\f[R].
.TP
\f[B]\-\-version\f[R], \f[B]\-v\f[R]
Print version information and quit.
.SH EXIT STATUS
.TP
\f[B]0\f[R]
Success.
Program executed without errors.
.TP
\f[B]1\f[R]
Failure.
Program execution failed.
.SH ENVIRONMENT
.TP
\f[B]NO_COLOR\f[R]
Disable ANSI colour output.
.SH EXAMPLE
Create a POSIX message queue \f[CR]/dmlogger\f[R] and wait for incoming
logs:
.IP
.EX
$ dmlogger \-N dummy\-node \-d /var/dmpack/log.db \-L info
.EE
.PP
Received logs are inserted only if they are of level \f[I]info\f[R] or
higher.
.SH SEE ALSO
\f[I]dmlog(1)\f[R], \f[I]dmsync(1)\f[R]
