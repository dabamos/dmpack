.TH "DMBOT" "1" "" "Version 2.0.0" "User Commands"
.SH NAME
dmbot \(en XMPP chat bot for remote control of sensor nodes
.SH SYNOPSIS
\f[B]dmbot\f[R] \-\-help
.PP
\f[B]dmbot\f[R] \-\-version
.PP
\f[B]dmbot\f[R] \-\-\f[B]node\f[R] \f[I]id\f[R] \-\-\f[B]jid\f[R]
\f[I]jid\f[R] \-\-\f[B]password\f[R] \f[I]password\f[R]
\-\-\f[B]host\f[R] \f[I]host\f[R] [\-\-\f[B]port\f[R] \f[I]port\f[R]]
[\-\-\f[B]tls\f[R]] [\-\-\f[B]logger\f[R] \f[I]name\f[R]]
[\-\-\f[B]debug\f[R]] [\-\-\f[B]verbose\f[R]]
.PP
\f[B]dmbot\f[R] \-\-\f[B]config\f[R] \f[I]file\f[R] [\-\-\f[B]name\f[R]
\f[I]name\f[R]]
.SH DESCRIPTION
This program is an XMPP bot that accepts commands via chat.
Access to the bot is limited to the JIDs added to table \f[CR]group\f[R]
in the configuration file.
Requests from clients whose JID is not in the table will be rejected.
If table \f[CR]group\f[R] is empty, all clients are allowed to send
commands to the bot.
.PP
All commands start with prefix \f[CR]!\f[R].
For an overview, send chat command \f[CR]!help\f[R] to the bot.
The bot understands the following commands:
.TP
!beats
Return current time of the sensor node in Swatch Internet Time.
.TP
!date
Return date and time of the sensor node in ISO 8601.
.TP
!help
Return help text.
.TP
!jid
Return full JID of bot.
.TP
!log <level> \(dq<message>\(dq
Send log message of given level to logger.
The argument \f[CR]level\f[R] must be a valid log level name or numeric
log level.
The argument \f[CR]message\f[R] must be in quotes.
.TP
!node
Return node id of bot.
.TP
!poke
Return status message if bot is online.
.TP
!reconnect
Reconnect bot to server.
.TP
!uname
Return name and version of the operating system.
.TP
!uptime
Return uptime of the operating system
.TP
!version
Return bot version.
.PP
Passing the XMPP credentials via the command\-line arguments
\f[CR]\-\-jid\f[R] and \f[CR]\-\-password\f[R] is insecure on
multi\-user operating systems and only recommended for testing.
.SH OPTIONS
.TP
\f[B]\-\-config\f[R], \f[B]\-c\f[R] \f[I]file\f[R]
Path to Lua\-based configuration file.
.TP
\f[B]\-\-debug\f[R], \f[B]\-D\f[R]
Forward logs messages of level \f[CR]LL_DEBUG\f[R] via IPC (if logger is
set).
.TP
\f[B]\-\-help\f[R], \f[B]\-h\f[R]
Print available command\-line arguments and quit.
.TP
\f[B]\-\-host\f[R], \f[B]\-H\f[R] \f[I]host\f[R]
Domain of XMPP server.
.TP
\f[B]\-\-jid\f[R], \f[B]\-J\f[R] \f[I]user\f[R]
Jabber id (JID) of the form \f[CR]user\(atexample.com\f[R].
.TP
\f[B]\-\-logger\f[R], \f[B]\-l\f[R] \f[I]name\f[R]
Name of logger.
If set, sends logs to \f[I]dmlogger(1)\f[R] process of given name.
.TP
\f[B]\-\-name\f[R], \f[B]\-n\f[R] \f[I]name\f[R]
Name of instance, XMPP resource, and table in given configuration file
(default is \f[CR]dmbot\f[R]).
.TP
\f[B]\-\-node\f[R], \f[B]\-N\f[R] \f[I]id\f[R]
Sensor node id.
.TP
\f[B]\-\-password\f[R], \f[B]\-P\f[R] \f[I]password\f[R]
JID password.
Be aware that passing the credentials via command\-line arguments is
insecure and only recommended for testing.
.TP
\f[B]\-\-port\f[R], \f[B]\-q\f[R] \f[I]port\f[R]
Port of XMPP server.
The default port is 5222.
.TP
\f[B]\-\-reconnect\f[R], \f[B]\-R\f[R]
Reconnect on error.
.TP
\f[B]\-\-tls\f[R], \f[B]\-E\f[R]
Force TLS encryption.
.TP
\f[B]\-\-verbose\f[R], \f[B]\-V\f[R]
Print log messages to \f[I]stderr\f[R].
.TP
\f[B]\-\-version\f[R], \f[B]\-v\f[R]
Print version information and quit.
.SH EXIT STATUS
.TP
\f[B]0\f[R]
Success.
Program executed without errors.
.TP
\f[B]1\f[R]
Failure.
Program execution failed.
.SH ENVIRONMENT
.TP
\f[B]DM_LOGGER\f[R]
Name of logger instance to send logs to.
.TP
\f[B]NO_COLOR\f[R]
Disable ANSI colour output.
.SH EXAMPLE
Connect with JID \f[CR]bot\(atexample.com\f[R] to an XMPP server on port
5223 and wait for commands:
.IP
.EX
$ dmbot \-N dummy\-node \-J bot\(atexample.com \-P secret \(rs
  \-H example.com \-q 5223 \-E \-V
.EE
.PP
If no configuration file is used, any client may send commands to the
bot without authorisation.
