.TH "DMBEAT" "1" "" "Version 2.0.0" "User Commands"
.SH NAME
dmbeat \(en sends status messages to an RPC server
.SH SYNOPSIS
\f[B]dmbeat\f[R] \-\-help
.PP
\f[B]dmbeat\f[R] \-\-version
.PP
\f[B]dmbeat\f[R] \-\-\f[B]node\f[R] \f[I]id\f[R] \-\-\f[B]host\f[R]
\f[I]host\f[R] [\-\-\f[B]port\f[R] \f[I]port\f[R]] [\-\-\f[B]tls\f[R]]
[\-\-\f[B]username\f[R] \f[I]user\f[R]] [\-\-\f[B]password\f[R]
\f[I]password\f[R]] [\-\-\f[B]count\f[R] \f[I]n\f[R]]
[\-\-\f[B]interval\f[R] \f[I]seconds\f[R]] [\-\-\f[B]compression\f[R]
\f[I]name\f[R]] [\-\-\f[B]logger\f[R] \f[I]name\f[R]]
[\-\-\f[B]debug\f[R]] [\-\-\f[B]verbose\f[R]]
.PP
\f[B]dmbeat\f[R] \-\-\f[B]config\f[R] \f[I]file\f[R] [\-\-\f[B]name\f[R]
\f[I]name\f[R]]
.SH DESCRIPTION
This program is a heartbeat emitter that sends status messages to a
remote DMPACK HTTP\-RPC API.
The status messages include timestamp, system uptime, and last
connection error.
The server may inspect this data to check if a client is still running
and has network access.
The RPC endpoint is expected at
\f[CR][http|https]://<host>:<port>/api/v1/beat\f[R].
The heartbeat is transmitted in Zstandard\-compressed Fortran 95
Namelist format.
.PP
Passing the server credentials via the command\-line arguments
\f[CR]\-\-username\f[R] and \f[CR]\-\-password\f[R] is insecure on
multi\-user operating systems and only recommended for testing.
.SH OPTIONS
.TP
\f[B]\-\-compression\f[R], \f[B]\-x\f[R] \f[I]name\f[R]
Compression library to use for payload data (\f[CR]none\f[R],
\f[CR]zlib\f[R], \f[CR]zstd\f[R]).
The default is \f[CR]zstd\f[R] (Z standard).
Select \f[CR]zlib\f[R] for deflate compression.
.TP
\f[B]\-\-config\f[R], \f[B]\-c\f[R] \f[I]file\f[R]
Path to Lua\-based configuration file.
.TP
\f[B]\-\-count\f[R], \f[B]\-C\f[R] \f[I]n\f[R]
Maximum number of heartbeats to send.
The default is 0 (unlimited).
.TP
\f[B]\-\-debug\f[R], \f[B]\-D\f[R]
Forward logs messages of level \f[CR]LL_DEBUG\f[R] via IPC (if logger is
set).
.TP
\f[B]\-\-help\f[R], \f[B]\-h\f[R]
Print available command\-line arguments and quit.
.TP
\f[B]\-\-host\f[R], \f[B]\-H\f[R] \f[I]host\f[R]
IP or FQDN of RPC host (for example, \f[CR]127.0.0.1\f[R] or
\f[CR]example.com\f[R]).
.TP
\f[B]\-\-interval\f[R], \f[B]\-I\f[R] \f[I]seconds\f[R]
Emit interval in seconds (default is 60 seconds).
.TP
\f[B]\-\-logger\f[R], \f[B]\-l\f[R] \f[I]name\f[R]
Name of logger.
If set, sends logs to \f[I]dmlogger(1)\f[R] process of given name.
.TP
\f[B]\-\-name\f[R], \f[B]\-n\f[R] \f[I]name\f[R]
Name of instance and table in given configuration file (default is
\f[CR]dmbeat\f[R]).
.TP
\f[B]\-\-node\f[R], \f[B]\-N\f[R] \f[I]id\f[R]
Sensor node id.
.TP
\f[B]\-\-password\f[R], \f[B]\-P\f[R] \f[I]password\f[R]
RPC API password.
Be aware that passing the credentials via command\-line arguments is
insecure and only recommended for testing.
.TP
\f[B]\-\-port\f[R], \f[B]\-q\f[R] \f[I]port\f[R]
Port of RPC API server.
The default port is 0 (automatic selection depending on protocol).
.TP
\f[B]\-\-tls\f[R], \f[B]\-E\f[R]
Use TLS encryption.
.TP
\f[B]\-\-username\f[R], \f[B]\-U\f[R] \f[I]user\f[R]
RPC API user name.
If set, implies HTTP Basic Auth.
.TP
\f[B]\-\-verbose\f[R], \f[B]\-V\f[R]
Print log messages to \f[I]stderr\f[R].
.TP
\f[B]\-\-version\f[R], \f[B]\-v\f[R]
Print version information and quit.
.SH EXIT STATUS
.TP
\f[B]0\f[R]
Success.
Beat has been transmitted.
.TP
\f[B]1\f[R]
Failure.
Beat transmission failed.
.SH ENVIRONMENT
.TP
\f[B]DM_LOGGER\f[R]
Name of logger instance to send logs to.
.TP
\f[B]NO_COLOR\f[R]
Disable ANSI colour output.
.SH EXAMPLE
Send a single heartbeat to a \f[I]dmapi(1)\f[R] process on localhost:
.IP
.EX
$ dmbeat \-N dummy\-node \-H 127.0.0.1 \-C 1 \-V
.EE
.SH SEE ALSO
\f[I]dmapi(1)\f[R]
