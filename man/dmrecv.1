.\" Automatically generated by Pandoc 3.8.3
.\"
.TH "DMRECV" "1" "" "Version 2.0.0" "User Commands"
.SH NAME
dmrecv \(en receives observations and logs from POSIX message queue
.SH SYNOPSIS
\f[B]dmrecv\f[R] \-\-help
.PP
\f[B]dmrecv\f[R] \-\-version
.PP
\f[B]dmrecv\f[R] \-\-\f[B]type\f[R] [log|observ] \-\-\f[B]format\f[R]
[block|csv|jsonl|nml] [\-\-\f[B]name\f[R] \f[I]name\f[R]]
[\-\-\f[B]output\f[R] \f[I]file\f[R]] [\-\-\f[B]response\f[R]
\f[I]name\f[R]] [\-\-\f[B]node\f[R] \f[I]id\f[R]] [\-\-\f[B]logger\f[R]
\f[I]name\f[R]] [\-\-\f[B]forward\f[R]] [\-\-\f[B]replace\f[R]]
[\-\-\f[B]verbose\f[R]]
.PP
\f[B]dmrecv\f[R] \-\-\f[B]config\f[R] \f[I]file\f[R] [\-\-\f[B]name\f[R]
\f[I]name\f[R]]
.SH DESCRIPTION
The \f[B]dmrecv\f[R] program listens to the POSIX message queue of its
name and writes received observations and logs to \f[I]stdout\f[R],
file, or named pipe; in ASCII block, CSV, JSON, or Fortran 95 Namelist
format.
By default, the serialised data is appended to the end of the output
file.
If argument \f[CR]\-\-replace\f[R] is passed, the file will be replaced
consecutively.
.PP
Received observations are not forwarded to the next specified receiver,
unless argument \f[CR]\-\-forward\f[R] is set.
If no receivers are defined or left, the observation will be discarded
after output.
.PP
The output format \f[CR]block\f[R] is available for observation data
only, and requires a valid response name.
Received observations will be searched for this response and converted
to data point type if found.
The data point is printed in ASCII block format.
.PP
If output format JSON Lines is selected, observations and logs are
written sequentially as JSON objects to file or \f[I]stdout\f[R],
separated by new line.
Use \f[I]jq(1)\f[R] to convert a file \f[CR]input.jsonl\f[R] of JSON
objects to a JSON array in \f[CR]output.json\f[R]:
.IP
.EX
$ jq \-s \(aq.\(aq input.jsonl > output.json
.EE
.PP
The program settings are passed through command\-line arguments or an
optional configuration file.
The arguments overwrite settings from file.
.SH OPTIONS
.TP
\f[B]\-\-config\f[R], \f[B]\-c\f[R] \f[I]file\f[R]
Path to configuration file.
.TP
\f[B]\-\-debug\f[R], \f[B]\-D\f[R]
Forward logs messages of level \f[CR]LL_DEBUG\f[R] via IPC (if logger is
set).
.TP
\f[B]\-\-format\f[R], \f[B]\-f\f[R] [block|csv|jsonl|nml]
Output format, either ASCII block, CSV, JSON Lines, or Namelist.
Format \f[CR]block\f[R] is allowed for type \f[CR]observ\f[R] only.
.TP
\f[B]\-\-forward\f[R], \f[B]\-F\f[R]
Forward each observation to its next specified receiver.
.TP
\f[B]\-\-help\f[R], \f[B]\-h\f[R]
Print available command\-line arguments and quit.
.TP
\f[B]\-\-logger\f[R], \f[B]\-l\f[R] \f[I]name\f[R]
Name of logger.
If set, sends logs to \f[I]dmlogger(1)\f[R] process of given name.
.TP
\f[B]\-\-name\f[R], \f[B]\-n\f[R] \f[I]name\f[R]
Name of configuration and POSIX message queue (default is
\f[CR]dmrecv\f[R]).
.TP
\f[B]\-\-node\f[R], \f[B]\-N\f[R] \f[I]id\f[R]
Optional node id.
.TP
\f[B]\-\-output\f[R], \f[B]\-o\f[R] \f[I]file\f[R]
Path of output file.
Prints serialised data to \f[I]stdout\f[R] if \f[CR]\-\f[R] or not set.
.TP
\f[B]\-\-replace\f[R], \f[B]\-r\f[R]
Replace output file instead of appending data.
.TP
\f[B]\-\-response\f[R], \f[B]\-R\f[R] \f[I]name\f[R]
Name of the observation response to output (required for format
\f[CR]block\f[R]).
.TP
\f[B]\-\-type\f[R], \f[B]\-t\f[R] [log|observ]
Data type to receive, either log or observation.
.TP
\f[B]\-\-verbose\f[R], \f[B]\-V\f[R]
Print log messages to \f[I]stderr\f[R].
.TP
\f[B]\-\-version\f[R], \f[B]\-v\f[R]
Print version information and quit.
.SH EXIT STATUS
.TP
\f[B]0\f[R]
Success.
Program terminated normally.
.TP
\f[B]1\f[R]
Failure.
Program execution failed.
.SH ENVIRONMENT
.TP
\f[B]DM_LOGGER\f[R]
Name of logger instance to send logs to.
.TP
\f[B]NO_COLOR\f[R]
Disable ANSI colour output.
.SH EXAMPLE
Write received log messages in CSV format to file
\f[CR]/tmp/logs.csv\f[R]:
.IP
.EX
$ dmrecv \-n dmrecv \-t log \-f csv \-o /tmp/logs.csv
.EE
.PP
Output observations in JSON format to \f[I]stdout\f[R]:
.IP
.EX
$ dmrecv \-n dmrecv \-t observ \-f json
.EE
.PP
Output observation responses of name \f[CR]x\f[R] in ASCII block format
to \f[I]stdout\f[R]:
.IP
.EX
$ dmrecv \-n dmrecv \-t observ \-f block \-R x
.EE
.SH SEE ALSO
\f[I]dmsend(1)\f[R]
